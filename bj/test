import sys
import itertools
from collections import deque
m, n = map(int, input().split())
box = []
d = deque()
for i in range(n):
    row = list(map(int, sys.stdin.readline().split()))
    for j in range(m):
        if row[j] == 1:
            d.append([i, j, 0])
    box.append(row)

if len(d) == m*n:
    print(0)
else:
    visited = [[0]*m for _ in range(n)]
    Flag = True
    while True:
        pos = d.popleft()
        x, y, day = pos[0], pos[1], pos[2]
        box[x][y] = 1
        if x+1 >= 0 and y >= 0 and x+1 < n and y < m:
            if visited[x+1][y] == 0 and box[x+1][y] == 0:
                visited[x+1][y] = 1
                d.append([x+1, y, day+1])
        if x >= 0 and y+1 >= 0 and x < n and y+1 < m:
            if visited[x][y+1] == 0 and box[x][y+1] == 0:
                visited[x][y+1] = 1
                d.append([x, y+1, day+1])
        if x-1 >= 0 and y >= 0 and x-1 < n and y < m:
            if visited[x-1][y] == 0 and box[x-1][y] == 0:
                visited[x - 1][y] = 1
                d.append([x-1, y, day+1])
        if x >= 0 and y-1 >= 0 and x < n and y-1 < m:
            if visited[x][y-1] == 0 and box[x][y-1] == 0:
                visited[x][y-1] = 1
                d.append([x, y-1, day+1])
        if len(d) == 0:
            if 0 in itertools.chain(*box):
                print(-1)
            else:
                print(day)
            break
